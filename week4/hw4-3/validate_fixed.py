import base64
code="aW1wb3J0IHB5bW9uZ28KaW1wb3J0IHJhbmRvbQppbXBvcnQgcmUKaW1wb3J0IHN0cmluZwppbXBvcnQgc3lzCmltcG9ydCBnZXRvcHQKaW1wb3J0IHBwcmludAoKIyBDb3B5cmlnaHQgMjAxMgojIDEwZ2VuLCBJbmMuCiMgQXV0aG9yOiBBbmRyZXcgRXJsaWNoc29uICAgYWplQDEwZ2VuLmNvbQojCiMgSWYgeW91IGFyZSBhIHN0dWRlbnQgYW5kIHJlYWRpbmcgdGhpcyBjb2RlLCB0dXJuIGJhY2sgbm93LCBiZWZvcmUKIyB0aGUgTW9uZ29EQiBnb2RzIHNtaXRlIHlvdS4KCmNvbm5lY3Rpb24gPSBOb25lCmRiID0gTm9uZQp3ZWJob3N0ID0gImxvY2FsaG9zdDo4MDgyIgptb25nb3N0ciA9ICJtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3IgpkYl9uYW1lID0gImJsb2ciCgojIHRoaXMgc2NyaXB0IHdpbGwgY2hlY2sgdGhhdCBob21ld29yayA0LjMKCiMgY29tbWFuZCBsaW5lIGFyZyBwYXJzaW5nIHRvIG1ha2UgZm9sa3MgaGFwcHkgd2hvIHdhbnQgdG8gcnVuIGF0IG1vbmdvbGFicyBvciBtb25nb2hxCiMgdGhpcyBmdW5jdGlvbnMgdXNlcyBnbG9iYWwgdmFycyB0byBjb21tdW5pY2F0ZS4gZm9yZ2l2ZSBtZS4KZGVmIGFyZ19wYXJzaW5nKGFyZ3YpOgoKICAgIGdsb2JhbCB3ZWJob3N0CiAgICBnbG9iYWwgbW9uZ29zdHIKICAgIGdsb2JhbCBkYl9uYW1lCgogICAgdHJ5OgogICAgICAgIG9wdHMsIGFyZ3MgPSBnZXRvcHQuZ2V0b3B0KGFyZ3YsICItcDotbTotZDoiKQogICAgZXhjZXB0IGdldG9wdC5HZXRvcHRFcnJvcjoKICAgICAgICBwcmludCAidXNhZ2UgdmFsaWRhdGUucHkgLXAgd2ViaG9zdCAtbSBtb25nb0Nvbm5lY3RTdHJpbmcgLWQgZGF0YWJhc2VOYW1lIgogICAgICAgIHByaW50ICJcdG1vbmdvQ29ubmVjdGlvblN0cmluZyBkZWZhdWx0IHRvIHswfSIuZm9ybWF0KG1vbmdvc3RyKQogICAgICAgIHByaW50ICJcdGRhdGFiYXNlTmFtZSBkZWZhdWx0cyB0byB7MH0iLmZvcm1hdChkYl9uYW1lKQogICAgICAgIHN5cy5leGl0KDIpCiAgICBmb3Igb3B0LCBhcmcgaW4gb3B0czoKICAgICAgICBpZiAob3B0ID09ICctaCcpOgogICAgICAgICAgICBwcmludCAidXNhZ2UgdmFsaWRhdGUucHkgLW0gbW9uZ29Db25uZWN0U3RyaW5nIC1kIGRhdGFiYXNlTmFtZSIKICAgICAgICAgICAgc3lzLmV4aXQoMikKICAgICAgICBlbGlmIG9wdCBpbiAoIi1tIik6CiAgICAgICAgICAgIG1vbmdvc3RyID0gYXJnCiAgICAgICAgICAgIHByaW50ICJPdmVycmlkaW5nIE1vbmdvREIgY29ubmVjdGlvbiBzdHJpbmcgdG8gYmUgIiwgbW9uZ29zdHIKICAgICAgICBlbGlmIG9wdCBpbiAoIi1kIik6CiAgICAgICAgICAgIGRiX25hbWUgPSBhcmcKICAgICAgICAgICAgcHJpbnQgIk92ZXJyaWRpbmcgTW9uZ29EQiBkYXRhYmFzZSB0byBiZSAiLCBkYl9uYW1lCgojIGNoZWNrIHRvIHNlZSBpZiB0aGV5IGxvYWRlZCB0aGUgZGF0YSBzZXQKZGVmIGNoZWNrX2Zvcl9kYXRhX2ludGVncml0eSgpOgoKICAgIHBvc3RzID0gZGIucG9zdHMKICAgIHRyeToKICAgICAgICBjb3VudCA9IHBvc3RzLmNvdW50KCkKICAgIGV4Y2VwdDoKICAgICAgICBwcmludCAiY2FuJ3QgcXVlcnkgTW9uZ29EQi4uaXMgaXQgcnVubmluZz8iCiAgICAgICAgcmFpc2UKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBpZiAoY291bnQgIT0gMTAwMCk6CiAgICAgICAgcHJpbnQgIlRoZXJlIGFyZSBzdXBwb3NlZCB0byBiZSAxMDAwIGRvY3VtZW50cy4geW91IGhhdmUgIiwgY291bnQKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAjIGZpbmQgdGhlIG1vc3QgcG9wdWxhciB0YWdzCiAgICB0cnk6CgogICAgICAgIHJlc3VsdCA9IGRiLnBvc3RzLmFnZ3JlZ2F0ZShbeyckcHJvamVjdCc6eyd0YWdzJzoxfX0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyckdW53aW5kJzonJHRhZ3MnfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7JyRncm91cCc6eydfaWQnOiAnJHRhZ3MnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOnsnJHN1bSc6MX19fSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7JyRzb3J0Jzp7J2NvdW50JzotMX19LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnJGxpbWl0JzoxMH1dKQogICAgZXhjZXB0OgogICAgICAgIHByaW50ICJjYW4ndCBxdWVyeSBNb25nb0RCLi5pcyBpdCBydW5uaW5nPyIKICAgICAgICByYWlzZQogICAgICAgIHJldHVybiBGYWxzZQoKCiAgICBpZiAocmVzdWx0WydyZXN1bHQnXVswXVsnY291bnQnXSAhPSAxMyBvcgogICAgICAgIHJlc3VsdFsncmVzdWx0J11bMF1bJ19pZCddICE9ICJzcGh5bngiKToKICAgICAgICBwcmludCAiVGhlIGRhdGFzZXQgaXMgbm90IHByb3Blcmx5IGxvYWRlZC4gVGhlIGRpc3RyaWJ1dGlvbiBvZiBwb3N0IHRhZ3MgaXMgd3JvbmcuIgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIHByaW50ICJEYXRhIGxvb2tzIGxpa2UgaXQgaXMgcHJvcGVybHkgbG9hZGVkIGludG8gdGhlIHBvc3RzIGNvbGxlY3Rpb24iCgogICAgcmV0dXJuIFRydWUKICAgIAoKZGVmIGNoZWNrX2Zvcl9mYXN0X2Jsb2dfaG9tZV9wYWdlKCk6CgogICAgcG9zdHMgPSBkYi5wb3N0cwoKICAgIHRyeToKICAgICAgICBleHBsYWluID0gcG9zdHMuZmluZCgpLnNvcnQoJ2RhdGUnLCBkaXJlY3Rpb249LTEpLmxpbWl0KDEwKS5leHBsYWluKCkKICAgIGV4Y2VwdDoKICAgICAgICBwcmludCAiY2FuJ3QgcXVlcnkgTW9uZ29EQi4uaXMgaXQgcnVubmluZz8iCiAgICAgICAgcmFpc2UKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBpZiAoZXhwbGFpblsnbnNjYW5uZWRPYmplY3RzJ10gPiAxMCk6CiAgICAgICAgcHJpbnQgIlNvcnJ5LCBleGVjdXRpbmcgdGhlIHF1ZXJ5IHRvIGRpc3BsYXkgdGhlIGhvbWUgcGFnZSBpcyB0b28gc2xvdy4gIgogICAgICAgIHByaW50ICJXZSBzaG91bGQgYmUgc2Nhbm5pbmcgbm8gbW9yZSB0aGFuIDEwIGRvY3VtZW50cy4gWW91IHNjYW5uZWQiLCBleHBsYWluWyduc2Nhbm5lZE9iamVjdHMnXQogICAgICAgIHByaW50ICJoZXJlIGlzIHRoZSBvdXRwdXQgZnJvbSBleHBsYWluIgoKICAgICAgICBwcCA9IHBwcmludC5QcmV0dHlQcmludGVyKGRlcHRoPTYpCiAgICAgICAgcHAucHByaW50KGV4cGxhaW4pCiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAKICAgIHByaW50ICJIb21lIHBhZ2UgaXMgc3VwZXIgZmFzdC4gTmljZSBqb2IuXG4iCiAgICByZXR1cm4gVHJ1ZQoKZGVmIGdldF90aGVfbWlkZGxlX3Blcm1hbGluaygpOgogICAgcG9zdHMgPSBkYi5wb3N0cwogICAgdHJ5OgogICAgICAgIGMgPSBwb3N0cy5maW5kKCkuc2tpcCg1MDApLmxpbWl0KDEpCiAgICAgICAgZm9yIGRvYyBpbiBjOgogICAgICAgICAgICBwZXJtYWxpbmsgPSBkb2NbJ3Blcm1hbGluayddCiAgICAgICAgICAgIHJldHVybiBwZXJtYWxpbmsKICAgIGV4Y2VwdDoKICAgICAgICBwcmludCAiY2FuJ3QgcXVlcnkgTW9uZ29EQi4uaXMgaXQgcnVubmluZz8iCiAgICAgICAgcmFpc2UKICAgIHJldHVybiAiIgoKZGVmIGNoZWNrX2Zvcl9mYXN0X2Jsb2dfZW50cnlfcGFnZSgpOgogICAgCiAgICBwb3N0cyA9IGRiLnBvc3RzCgogICAgcGVybWFsaW5rID0gZ2V0X3RoZV9taWRkbGVfcGVybWFsaW5rKCkKICAgIHRyeToKICAgICAgICBleHBsYWluID0gcG9zdHMuZmluZCh7J3Blcm1hbGluayc6cGVybWFsaW5rfSkuZXhwbGFpbigpCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQgImNhbid0IHF1ZXJ5IE1vbmdvREIuLmlzIGl0IHJ1bm5pbmc/IgogICAgICAgIHJhaXNlCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgaWYgKGV4cGxhaW5bJ25zY2FubmVkT2JqZWN0cyddID4gMSk6CiAgICAgICAgcHJpbnQgIlNvcnJ5LCBleGVjdXRpbmcgdGhlIHF1ZXJ5IHRvIHJldHJpZXZlIGEgcG9zdCBieSBwZXJtYWxpbmsgaXMgdG9vIHNsb3cgIgogICAgICAgIHByaW50ICJXZSBzaG91bGQgYmUgc2Nhbm5pbmcgbm8gbW9yZSB0aGFuIDEgZG9jdW1lbnRzLiBZb3Ugc2Nhbm5lZCIsIGV4cGxhaW5bJ25zY2FubmVkT2JqZWN0cyddCiAgICAgICAgcHJpbnQgImhlcmUgaXMgdGhlIG91dHB1dCBmcm9tIGV4cGxhaW4iCgogICAgICAgIHBwID0gcHByaW50LlByZXR0eVByaW50ZXIoZGVwdGg9NikKICAgICAgICBwcC5wcHJpbnQoZXhwbGFpbikKICAgICAgICByZXR1cm4gRmFsc2UKICAgIAogICAgcHJpbnQgIkJsb2cgcmV0cmlldmFsIGJ5IHBlcm1hbGluayBpcyBzdXBlciBmYXN0LiBOaWNlIGpvYi5cbiIKICAgIHJldHVybiBUcnVlCgoKZGVmIGNoZWNrX2Zvcl9mYXN0X3Bvc3RzX2J5X3RhZ19wYWdlKCk6CiAgICBwb3N0cyA9IGRiLnBvc3RzCgogICAgdGFnID0gInNwaHlueCIKICAgIHRyeToKICAgICAgICBleHBsYWluID0gcG9zdHMuZmluZCh7J3RhZ3MnOnRhZ30pLnNvcnQoJ2RhdGUnLCBkaXJlY3Rpb249LTEpLmxpbWl0KDEwKS5leHBsYWluKCkKICAgIGV4Y2VwdDoKICAgICAgICBwcmludCAiY2FuJ3QgcXVlcnkgTW9uZ29EQi4uaXMgaXQgcnVubmluZz8iCiAgICAgICAgcmFpc2UKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBpZiAoZXhwbGFpblsnbnNjYW5uZWRPYmplY3RzJ10gPiAxMCk6CiAgICAgICAgcHJpbnQgIlNvcnJ5LCBleGVjdXRpbmcgdGhlIHF1ZXJ5IHRvIHJldHJpZXZlIHBvc3RzIGJ5IHRhZyBpcyB0b28gc2xvdy4iCiAgICAgICAgcHJpbnQgIldlIHNob3VsZCBiZSBzY2FubmluZyBubyBtb3JlIHRoYW4gMTAgZG9jdW1lbnRzLiBZb3Ugc2Nhbm5lZCIsIGV4cGxhaW5bJ25zY2FubmVkT2JqZWN0cyddCiAgICAgICAgcHJpbnQgImhlcmUgaXMgdGhlIG91dHB1dCBmcm9tIGV4cGxhaW4iCgogICAgICAgIHBwID0gcHByaW50LlByZXR0eVByaW50ZXIoZGVwdGg9NikKICAgICAgICBwcC5wcHJpbnQoZXhwbGFpbikKICAgICAgICByZXR1cm4gRmFsc2UKICAgIAogICAgcHJpbnQgIkJsb2cgcmV0cmlldmFsIGJ5IHRhZyBpcyBzdXBlciBmYXN0LiBOaWNlIGpvYi5cbiIKICAgIHJldHVybiBUcnVlCgoKIyBtYWluIHNlY3Rpb24gb2YgdGhlIGNvZGUKZGVmIG1haW4oYXJndik6CiAgICAgICAgICAgIAogICAgYXJnX3BhcnNpbmcoYXJndikKICAgIGdsb2JhbCBjb25uZWN0aW9uCiAgICBnbG9iYWwgZGIKCiAgICBwcmludCAiV2VsY29tZSB0byB0aGUgSFcgNC4zIENoZWNrZXIuIE15IGpvYiBpcyB0byBtYWtlIHN1cmUgeW91IGFkZGVkIHRoZSBpbmRleGVzIgogICAgcHJpbnQgInRoYXQgbWFrZSB0aGUgYmxvZyBmYXN0IGluIHRoZSBmb2xsb3dpbmcgdGhyZWUgc2l0dWF0aW9ucyIKICAgIHByaW50ICJcdFdoZW4gc2hvd2luZyB0aGUgaG9tZSBwYWdlIgogICAgcHJpbnQgIlx0V2hlbiBmZXRjaGluZyBhIHBhcnRpY3VsYXIgcG9zdCIKICAgIHByaW50ICJcdFdoZW4gc2hvd2luZyBhbGwgcG9zdHMgZm9yIGEgcGFydGljdWxhciB0YWciCgogICAgIyBjb25uZWN0IHRvIHRoZSBkYiAobW9uZ29zdHIgd2FzIHNldCBpbiBhcmdfcGFyc2luZykKICAgIHRyeToKICAgICAgICBjb25uZWN0aW9uID0gcHltb25nby5Db25uZWN0aW9uKG1vbmdvc3RyLCBzYWZlPVRydWUpCiAgICAgICAgZGIgPSBjb25uZWN0aW9uW2RiX25hbWVdCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQgImNhbid0IGNvbm5lY3QgdG8gTW9uZ29EQiB1c2luZyIsIG1vbmdvc3RyLCAiLiBJcyBpdCBydW5uaW5nPyIKICAgICAgICBzeXMuZXhpdCgxKQogICAgICAgIAogICAgaWYgKG5vdCBjaGVja19mb3JfZGF0YV9pbnRlZ3JpdHkoKSk6CiAgICAgICAgcHJpbnQgIlNvcnJ5LCB0aGUgZGF0YSBzZXQgaXMgbm90IGxvYWRlZCBjb3JyZWN0bHkgaW4gdGhlIHBvc3RzIGNvbGxlY3Rpb24iCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBpZiAobm90IGNoZWNrX2Zvcl9mYXN0X2Jsb2dfaG9tZV9wYWdlKCkpOgogICAgICAgIHByaW50ICJTb3JyeSwgdGhlIHF1ZXJ5IHRvIGRpc3BsYXkgdGhlIGJsb2cgaG9tZSBwYWdlIGlzIHRvbyBzbG93LiIKICAgICAgICBzeXMuZXhpdCgxKQoKICAgIGlmIChub3QgY2hlY2tfZm9yX2Zhc3RfYmxvZ19lbnRyeV9wYWdlKCkpOgogICAgICAgIHByaW50ICJTb3JyeSwgdGhlIHF1ZXJ5IHRvIHJldHJpZXZlIGEgYmxvZyBwb3N0IGJ5IHBlcm1hbGluayBpcyB0b28gc2xvdy4iCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBpZiAobm90IGNoZWNrX2Zvcl9mYXN0X3Bvc3RzX2J5X3RhZ19wYWdlKCkpOgogICAgICAgIHByaW50ICJTb3JyeSwgdGhlIHF1ZXJ5IHRvIHJldHJpZXZlIGFsbCBwb3N0cyB3aXRoIGEgY2VydGFpbiB0YWcgaXMgdG9vIHNsb3ciCiAgICAgICAgc3lzLmV4aXQoMSkKICAgIAogICAgIyBpZiB5b3UgYXJlIHJlYWRpbmcgdGhpcyBpbiBjbGVhcnRleHQsIHlvdSBhcmUgdmlvbGF0aW5nIHRoZSBob25vciBjb2RlLgogICAgIyBZb3UgY2FuIHN0aWxsIHJlZGVlbSB5b3Vyc2VsZi4gR2V0IGl0IHdvcmtpbmcgYW5kIGRvbid0IHN1Ym1pdCB0aGUgdmFsaWRhdGlvbiBjb2RlIHVudGlsIHlvdSBkby4KICAgICMgQWxsIGEgbWFuIGhhcyBhdCB0aGUgZW5kIG9mIHRoZSBkYXkgaXMgaGlzIHdvcmQuCiAgICBwcmludCAiVGVzdHMgUGFzc2VkIGZvciBIVyA0LjMuIFlvdXIgSFcgNC4zIHZhbGlkYXRpb24gY29kZSBpcyAzNGY5anIyOXNoMjlmMjBmc3BsaW52IgoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKHN5cy5hcmd2WzE6XSkKCgo="

eval(compile(base64.b64decode(code), "<string>", 'exec'))

